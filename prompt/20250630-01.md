# =====================================================================
#  🚀  Claude Code RUNBOOK  –  ai-chat-api / ai-chat-ui Monorepo
#  (基点ブランチ: develop)
# =====================================================================
#  🎯 GLOBAL GOALS
#    1. すべての TODO をクリアして  yarn lint / yarn build = Error 0
#    2. 作業は feature/<todo-key> ← develop で行い、PR も develop 向け
#    3. 各ステップの START/DONE/FAIL と PR READY を Slack #dev-ci に通知
#
# =====================================================================
#  🗂️  REPO STRUCTURE（抜粋）
#    ai-chat-api         … Express API
#    ai-chat-ui      … Next.js App Router (BFF)
#      ├─ app/api/bff/**        ← BFF ルート
#      ├─ app/_schemas/**       ← Zod スキーマ専用
#      ├─ app/_utils/fetcher.ts ← fetch ラッパ
#      └─ scripts/slack-notify.sh
#
# =====================================================================
#  ⚙️  CLAUDE CODE SETTINGS
#  permissions.json
#  -----------------
#  {
#    "permissions": { "allow": ["Bash(*)","Git(*)","Yarn(*)","Docker(*)","Node(*)"], "deny": [] },
#    "auto_confirm": true
#  }
#
# =====================================================================
#  🔔  SLACK NOTIFY RULE
#    ./scripts/slack-notify.sh "START <todo-key>"
#    ./scripts/slack-notify.sh "DONE  <todo-key>"
#    ./scripts/slack-notify.sh "FAIL  <todo-key> : <stderr>"
#    ./scripts/slack-notify.sh "PR READY <branch>"
#
# =====================================================================
#  🌳  GIT WORKFLOW
#    • ブランチ : feature/<todo-key>  （develop から作成）
#    • Commit : <type>(<scope>): <subject>   例) feat(api): dashboard route
#      - type  = feat / fix / refactor / chore / test / docs
#      - scope = api | ui | hook | schema | config | infra
#      - 末尾に「#CI」で GitHub Actions 実行
#
# =====================================================================
#  🛡️  CODING RULE DIGEST
#    • fetch 直呼び禁止  → 必ず app/_utils/fetcher.ts 経由
#    • Zod 宣言          → app/_schemas/** のみ
#    • npm / pnpm 禁止   → Yarn 固定
#    • ESLint            → max-lines-per-function 100 / jsx-max-depth 5
#    • eslint-disable    → 原則禁止
#
# =====================================================================
#  🪜  TODO ROADMAP  （全 x セクション）
# ---------------------------------------------------------------------
#  ■ Section-1         
# ---------------------------------------------------------------------

...
# ---------------------------------------------------------------------
#  ■ Section-2  feat(api): dashboard Express route           <todo-key> dashboard-express
# ---------------------------------------------------------------------


# =====================================================================
#  
# ---------------------------------------------------------------------
slack-notify START finalize
git checkout develop
git merge --no-ff 
yarn format && yarn lint && yarn build
git commit -am "fix(lint): clear all errors #CI"
git push -u origin develop
gh pr create --base develop --fill
./scripts/slack-notify.sh "PR READY develop"
slack-notify DONE finalize
# =====================================================================
