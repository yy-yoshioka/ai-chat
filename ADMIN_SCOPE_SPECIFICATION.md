# 管理者パネル スコープ仕様書

## 現在の実装

### 法人管理者 (`role: 'admin'`)
現在実装されている管理者パネルは **各法人の管理者向け** です。

#### アクセス権限
- 自組織 (`organizationId`) のデータのみ操作可能
- 他法人のデータは表示・編集不可
- 組織内の全機能に対する管理権限

#### 管理機能
1. **ダッシュボード** (`/admin/dashboard`)
   - 自組織の運用状況監視
   - リアルタイム統計データ
   - 自組織ユーザーのアクティビティ

2. **FAQ管理** (`/admin/faq/*`)
   - 自組織専用FAQの作成・編集・削除
   - 自組織顧客向けコンテンツ管理

3. **ユーザー管理** (`/admin/users`)
   - 自組織の課金ユーザー管理
   - アカウント状態管理（アクティブ/停止など）
   - 自組織内でのユーザー権限管理

4. **チャット監視** (`/admin/chats`)
   - 自組織のチャットセッション監視
   - 顧客満足度分析
   - パフォーマンス追跡

5. **システム設定** (`/admin/settings`)
   - 自組織のAI設定カスタマイズ
   - 自組織専用のブランディング設定
   - セキュリティポリシー設定

6. **レポート** (`/admin/reports`)
   - 自組織のROI分析
   - 自組織の利用統計
   - カスタムレポート生成

7. **ログ監視** (`/admin/logs`)
   - 自組織のシステムログ
   - エラー追跡
   - セキュリティ監査

## 未実装（今後必要な機能）

### プラットフォーム管理者 (`role: 'super_admin'`)
SaaSプラットフォーム運営者向けの管理画面

#### 必要な機能
1. **全体ダッシュボード**
   - 全法人の統計データ
   - プラットフォーム全体の健康状態
   - 収益管理

2. **法人管理**
   - 新規法人の登録・設定
   - 法人ごとの契約管理
   - 法人管理者権限の付与

3. **課金・請求管理**
   - 法人ごとの利用量追跡
   - 自動請求処理
   - 料金プラン管理

4. **システム全体設定**
   - プラットフォームレベルの設定
   - APIレート制限
   - セキュリティポリシー

5. **監査・コンプライアンス**
   - 全法人の活動ログ
   - セキュリティ監査
   - コンプライアンス報告

## データ分離

### 現在の実装
```javascript
// 各法人管理者は organizationId でデータが分離される
const userAuth = {
  id: 'admin-1',
  role: 'admin',
  organizationId: 'org-demo',
  organizationName: 'デモ株式会社'
}
```

### 必要な改善
1. **API レベルでの分離**
   - 全API呼び出しで organizationId による自動フィルタリング
   - データアクセス権限の厳格な管理

2. **マルチテナント対応**
   - 法人ごとの完全なデータ分離
   - 組織間でのデータ漏洩防止

## セキュリティ考慮事項

### 現在の実装
- `AdminAuthGuard` による権限チェック
- 開発環境用のモック認証

### 強化が必要な点
1. **API レベルの権限チェック**
2. **組織スコープの厳格な管理**
3. **監査ログの実装**
4. **セッション管理の強化**

## 使用例

### 法人A（トヨタ）の管理者
```
ログイン → 管理者パネル → トヨタのデータのみ表示
- トヨタの顧客チャット
- トヨタ専用FAQ
- トヨタの設定・ブランディング
```

### 法人B（ソフトバンク）の管理者
```
ログイン → 管理者パネル → ソフトバンクのデータのみ表示
- ソフトバンクの顧客チャット
- ソフトバンク専用FAQ  
- ソフトバンクの設定・ブランディング
```

### プラットフォーム管理者（未実装）
```
ログイン → スーパー管理画面 → 全体の管理
- 全法人の統計
- 課金・契約管理
- システム全体設定
``` 