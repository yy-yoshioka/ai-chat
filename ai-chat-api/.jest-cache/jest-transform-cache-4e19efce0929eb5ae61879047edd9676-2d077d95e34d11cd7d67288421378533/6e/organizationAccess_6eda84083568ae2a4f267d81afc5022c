2c4a69a91fa31e7febe174bcc4525990
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requireOrganizationAccess = exports.orgAccessMiddleware = void 0;
const orgAccessMiddleware = (req, res, next) => {
    if (!req.user || !req.user.organizationId) {
        return res.status(403).json({ message: 'Organization access required' });
    }
    req.organizationId = req.user.organizationId;
    return next();
};
exports.orgAccessMiddleware = orgAccessMiddleware;
exports.requireOrganizationAccess = exports.orgAccessMiddleware;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3l1c3VrZXlvc2hpb2thL3Byb2plY3RzL3lvdXR1YmUvYWktY2hhdC9haS1jaGF0LWFwaS9zcmMvbWlkZGxld2FyZS9vcmdhbml6YXRpb25BY2Nlc3MudHMiLCJtYXBwaW5ncyI6Ijs7O0FBTU8sTUFBTSxtQkFBbUIsR0FBRyxDQUNqQyxHQUFZLEVBQ1osR0FBYSxFQUNiLElBQWtCLEVBQ2xCLEVBQUU7SUFDRixJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDMUMsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxDQUFDLENBQUM7SUFDM0UsQ0FBQztJQUNELEdBQUcsQ0FBQyxjQUFjLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDN0MsT0FBTyxJQUFJLEVBQUUsQ0FBQztBQUNoQixDQUFDLENBQUM7QUFWVyxRQUFBLG1CQUFtQix1QkFVOUI7QUFFVyxRQUFBLHlCQUF5QixHQUFHLDJCQUFtQixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXN1a2V5b3NoaW9rYS9wcm9qZWN0cy95b3V0dWJlL2FpLWNoYXQvYWktY2hhdC1hcGkvc3JjL21pZGRsZXdhcmUvb3JnYW5pemF0aW9uQWNjZXNzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tICdleHByZXNzJztcblxuZXhwb3J0IGludGVyZmFjZSBPcmdhbml6YXRpb25SZXF1ZXN0IGV4dGVuZHMgUmVxdWVzdCB7XG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBvcmdBY2Nlc3NNaWRkbGV3YXJlID0gKFxuICByZXE6IFJlcXVlc3QsXG4gIHJlczogUmVzcG9uc2UsXG4gIG5leHQ6IE5leHRGdW5jdGlvblxuKSA9PiB7XG4gIGlmICghcmVxLnVzZXIgfHwgIXJlcS51c2VyLm9yZ2FuaXphdGlvbklkKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgbWVzc2FnZTogJ09yZ2FuaXphdGlvbiBhY2Nlc3MgcmVxdWlyZWQnIH0pO1xuICB9XG4gIHJlcS5vcmdhbml6YXRpb25JZCA9IHJlcS51c2VyLm9yZ2FuaXphdGlvbklkO1xuICByZXR1cm4gbmV4dCgpO1xufTtcblxuZXhwb3J0IGNvbnN0IHJlcXVpcmVPcmdhbml6YXRpb25BY2Nlc3MgPSBvcmdBY2Nlc3NNaWRkbGV3YXJlO1xuIl0sInZlcnNpb24iOjN9