1e84470d4f140baaa7df38bcd3b514c8
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../../src/lib/prisma');
jest.mock('../../src/middleware/auth');
jest.mock('../../src/middleware/metrics');
const supertest_1 = __importDefault(require("supertest"));
const express_1 = __importDefault(require("express"));
const prisma_1 = require("../../src/lib/prisma");
const dashboard_1 = __importDefault(require("../../src/routes/dashboard"));
const auth_1 = require("../../src/middleware/auth");
const metrics_1 = require("../../src/middleware/metrics");
const test_data_1 = require("../fixtures/test-data");
describe('Dashboard Routes', () => {
    let app;
    beforeEach(() => {
        app = (0, express_1.default)();
        app.use(express_1.default.json());
        app.use('/api/dashboard', dashboard_1.default);
        // Setup middleware mocks
        auth_1.authMiddleware.mockImplementation((req, res, next) => {
            req.user = Object.assign(Object.assign({}, test_data_1.testUser), { organization: test_data_1.testOrganization });
            next();
        });
        metrics_1.metricsMiddleware.mockImplementation((req, res, next) => {
            next();
        });
        // Reset all mocks
        jest.clearAllMocks();
    });
    describe('GET /api/dashboard', () => {
        it('should return dashboard metrics successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockTotalChats = 1250;
            const mockActiveUsers = 45;
            const mockRecentChats = [
                { createdAt: new Date('2024-01-15T10:00:00Z') },
                { createdAt: new Date('2024-01-15T11:30:00Z') },
                { createdAt: new Date('2024-01-15T14:15:00Z') },
            ];
            // Mock Prisma queries
            prisma_1.prisma.chatLog.count.mockResolvedValue(mockTotalChats);
            prisma_1.prisma.user.count.mockResolvedValue(mockActiveUsers);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue(mockRecentChats);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body).toMatchObject({
                totalChats: mockTotalChats,
                activeUsers: mockActiveUsers,
                avgResponseTime: 250, // Hardcoded value
                errorRate: 0.02, // Hardcoded value
                timestamp: expect.any(String),
            });
            // Verify timestamp is valid ISO string
            expect(new Date(response.body.timestamp)).toBeInstanceOf(Date);
            expect(new Date(response.body.timestamp).getTime()).toBeGreaterThan(Date.now() - 5000); // Within last 5 seconds
        }));
        it('should query total chats count correctly', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(prisma_1.prisma.chatLog.count).toHaveBeenCalledWith();
        }));
        it('should query active users in last 24 hours correctly', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            const twentyFourHoursAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
            expect(prisma_1.prisma.user.count).toHaveBeenCalledWith({
                where: {
                    chatLogs: {
                        some: {
                            createdAt: {
                                gte: expect.any(Date),
                            },
                        },
                    },
                },
            });
            // Verify the date is approximately 24 hours ago (within 1 minute tolerance)
            const callArgs = prisma_1.prisma.user.count.mock.calls[0][0];
            const actualDate = callArgs.where.chatLogs.some.createdAt.gte;
            const timeDiff = Math.abs(actualDate.getTime() - twentyFourHoursAgo.getTime());
            expect(timeDiff).toBeLessThan(60000); // Less than 1 minute difference
        }));
        it('should query recent chats in last 24 hours correctly', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(prisma_1.prisma.chatLog.findMany).toHaveBeenCalledWith({
                where: {
                    createdAt: {
                        gte: expect.any(Date),
                    },
                },
                select: {
                    createdAt: true,
                },
            });
            // Verify only createdAt is selected for privacy and performance
            const callArgs = prisma_1.prisma.chatLog.findMany.mock.calls[0][0];
            expect(callArgs.select).toEqual({ createdAt: true });
        }));
        it('should execute all queries in parallel for performance', () => __awaiter(void 0, void 0, void 0, function* () {
            const countDelay = 100;
            const userCountDelay = 150;
            const findManyDelay = 120;
            prisma_1.prisma.chatLog.count.mockImplementation(() => new Promise((resolve) => setTimeout(() => resolve(100), countDelay)));
            prisma_1.prisma.user.count.mockImplementation(() => new Promise((resolve) => setTimeout(() => resolve(10), userCountDelay)));
            prisma_1.prisma.chatLog.findMany.mockImplementation(() => new Promise((resolve) => setTimeout(() => resolve([]), findManyDelay)));
            const startTime = Date.now();
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            const endTime = Date.now();
            const totalTime = endTime - startTime;
            // Should take roughly the time of the longest query (not the sum of all)
            expect(totalTime).toBeLessThan(countDelay + userCountDelay + findManyDelay);
            expect(totalTime).toBeGreaterThan(Math.max(countDelay, userCountDelay, findManyDelay) - 50);
        }));
        it('should return hardcoded avgResponseTime and errorRate', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.body.avgResponseTime).toBe(250);
            expect(response.body.errorRate).toBe(0.02);
        }));
        it('should round avgResponseTime and errorRate appropriately', () => __awaiter(void 0, void 0, void 0, function* () {
            var _a;
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            // avgResponseTime should be rounded to nearest integer
            expect(Number.isInteger(response.body.avgResponseTime)).toBe(true);
            // errorRate should be rounded to 3 decimal places
            expect(((_a = response.body.errorRate.toString().split('.')[1]) === null || _a === void 0 ? void 0 : _a.length) || 0).toBeLessThanOrEqual(3);
        }));
        it('should handle zero values gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(0);
            prisma_1.prisma.user.count.mockResolvedValue(0);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body).toMatchObject({
                totalChats: 0,
                activeUsers: 0,
                avgResponseTime: 250,
                errorRate: 0.02,
                timestamp: expect.any(String),
            });
        }));
        it('should handle large numbers correctly', () => __awaiter(void 0, void 0, void 0, function* () {
            const largeChatCount = 999999;
            const largeUserCount = 50000;
            prisma_1.prisma.chatLog.count.mockResolvedValue(largeChatCount);
            prisma_1.prisma.user.count.mockResolvedValue(largeUserCount);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body.totalChats).toBe(largeChatCount);
            expect(response.body.activeUsers).toBe(largeUserCount);
        }));
        it('should handle database errors gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockRejectedValue(new Error('Database connection failed'));
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(500);
            expect(response.body).toEqual({
                error: 'Failed to fetch dashboard data',
            });
        }));
        it('should handle partial database failures gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockRejectedValue(new Error('User query failed'));
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(500);
            expect(response.body).toEqual({
                error: 'Failed to fetch dashboard data',
            });
        }));
        it('should log errors to console', () => __awaiter(void 0, void 0, void 0, function* () {
            const consoleErrorSpy = jest
                .spyOn(console, 'error')
                .mockImplementation(() => { });
            const mockError = new Error('Database connection failed');
            prisma_1.prisma.chatLog.count.mockRejectedValue(mockError);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(consoleErrorSpy).toHaveBeenCalledWith('Dashboard error:', mockError);
            consoleErrorSpy.mockRestore();
        }));
        it('should handle null/undefined responses from database', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(null);
            prisma_1.prisma.user.count.mockResolvedValue(undefined);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue(null);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body).toMatchObject({
                totalChats: null,
                activeUsers: undefined,
                avgResponseTime: 250,
                errorRate: 0.02,
                timestamp: expect.any(String),
            });
        }));
        it('should handle empty recent chats array', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body.totalChats).toBe(100);
            expect(response.body.activeUsers).toBe(10);
        }));
        it('should handle recent chats with various timestamps', () => __awaiter(void 0, void 0, void 0, function* () {
            const recentChats = [
                { createdAt: new Date('2024-01-15T23:59:59Z') },
                { createdAt: new Date('2024-01-15T12:00:00Z') },
                { createdAt: new Date('2024-01-15T00:00:01Z') },
            ];
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue(recentChats);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body.totalChats).toBe(100);
            expect(response.body.activeUsers).toBe(10);
        }));
    });
    describe('Authentication and authorization', () => {
        it('should require authentication', () => __awaiter(void 0, void 0, void 0, function* () {
            auth_1.authMiddleware.mockImplementationOnce((req, res) => {
                res.status(401).json({ error: 'Unauthorized' });
            });
            const response = yield (0, supertest_1.default)(app).get('/api/dashboard');
            expect(response.status).toBe(401);
            expect(response.body).toEqual({ error: 'Unauthorized' });
        }));
        it('should not require admin permissions', () => __awaiter(void 0, void 0, void 0, function* () {
            // Regular user should be able to access dashboard
            const regularUser = Object.assign(Object.assign({}, test_data_1.testUser), { roles: ['user'] });
            auth_1.authMiddleware.mockImplementation((req, res, next) => {
                req.user = Object.assign(Object.assign({}, regularUser), { organization: test_data_1.testOrganization });
                next();
            });
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(regularUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
        }));
        it('should apply metrics middleware', () => __awaiter(void 0, void 0, void 0, function* () {
            const metricsMiddlewareSpy = jest.fn((req, res, next) => next());
            metrics_1.metricsMiddleware.mockImplementation(metricsMiddlewareSpy);
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(metricsMiddlewareSpy).toHaveBeenCalled();
        }));
        it('should apply middleware in correct order', () => __awaiter(void 0, void 0, void 0, function* () {
            const middlewareOrder = [];
            auth_1.authMiddleware.mockImplementation((req, res, next) => {
                middlewareOrder.push('auth');
                req.user = Object.assign(Object.assign({}, test_data_1.testUser), { organization: test_data_1.testOrganization });
                next();
            });
            metrics_1.metricsMiddleware.mockImplementation((req, res, next) => {
                middlewareOrder.push('metrics');
                next();
            });
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(middlewareOrder).toEqual(['auth', 'metrics']);
        }));
        it('should not proceed if auth middleware fails', () => __awaiter(void 0, void 0, void 0, function* () {
            auth_1.authMiddleware.mockImplementationOnce((req, res) => {
                res.status(401).json({ error: 'Token expired' });
            });
            const metricsMiddlewareSpy = jest.fn();
            metrics_1.metricsMiddleware.mockImplementation(metricsMiddlewareSpy);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer invalid-token`);
            expect(response.status).toBe(401);
            expect(metricsMiddlewareSpy).not.toHaveBeenCalled();
            expect(prisma_1.prisma.chatLog.count).not.toHaveBeenCalled();
        }));
    });
    describe('Performance considerations', () => {
        it('should handle concurrent requests efficiently', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            const requests = Array.from({ length: 10 }, () => (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`));
            const responses = yield Promise.all(requests);
            responses.forEach((response) => {
                expect(response.status).toBe(200);
                expect(response.body.totalChats).toBe(100);
            });
            expect(prisma_1.prisma.chatLog.count).toHaveBeenCalledTimes(10);
        }));
        it('should not fetch unnecessary data for performance', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            // Verify that only createdAt is selected from recent chats
            expect(prisma_1.prisma.chatLog.findMany).toHaveBeenCalledWith({
                where: expect.any(Object),
                select: { createdAt: true },
            });
            // Verify that we don't fetch full chat log data
            const callArgs = prisma_1.prisma.chatLog.findMany.mock.calls[0][0];
            expect(callArgs.select).not.toHaveProperty('question');
            expect(callArgs.select).not.toHaveProperty('answer');
            expect(callArgs.select).not.toHaveProperty('user');
        }));
        it('should handle timeout scenarios gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Mock a very slow database response
            prisma_1.prisma.chatLog.count.mockImplementation(() => new Promise(() => { }) // Never resolves
            );
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`)
                .timeout(1000);
            // The request should timeout, which supertest handles appropriately
            // In a real scenario, you might want to implement request timeouts in the route handler
        }));
    });
    describe('Data accuracy and consistency', () => {
        it('should use consistent 24-hour time window across queries', () => __awaiter(void 0, void 0, void 0, function* () {
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([]);
            yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            // Both user.count and chatLog.findMany should use the same time threshold
            const userCountCall = prisma_1.prisma.user.count.mock.calls[0][0];
            const chatLogFindCall = prisma_1.prisma.chatLog.findMany.mock
                .calls[0][0];
            const userDate = userCountCall.where.chatLogs.some.createdAt.gte;
            const chatDate = chatLogFindCall.where.createdAt.gte;
            // Dates should be very close (within 1 second due to execution time)
            const timeDiff = Math.abs(userDate.getTime() - chatDate.getTime());
            expect(timeDiff).toBeLessThan(1000);
        }));
        it('should handle edge case of exactly 24 hours ago', () => __awaiter(void 0, void 0, void 0, function* () {
            const exactlyTwentyFourHoursAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
            prisma_1.prisma.chatLog.count.mockResolvedValue(100);
            prisma_1.prisma.user.count.mockResolvedValue(10);
            prisma_1.prisma.chatLog.findMany.mockResolvedValue([
                { createdAt: exactlyTwentyFourHoursAgo },
            ]);
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body.totalChats).toBe(100);
        }));
        it('should maintain data consistency across parallel queries', () => __awaiter(void 0, void 0, void 0, function* () {
            let callCount = 0;
            const mockData = [150, 25, []]; // totalChats, activeUsers, recentChats
            prisma_1.prisma.chatLog.count.mockImplementation(() => {
                return Promise.resolve(mockData[0]);
            });
            prisma_1.prisma.user.count.mockImplementation(() => {
                return Promise.resolve(mockData[1]);
            });
            prisma_1.prisma.chatLog.findMany.mockImplementation(() => {
                return Promise.resolve(mockData[2]);
            });
            const response = yield (0, supertest_1.default)(app)
                .get('/api/dashboard')
                .set('Authorization', `Bearer ${(0, test_data_1.generateTestToken)(test_data_1.testUser.id, test_data_1.testOrganization.id)}`);
            expect(response.status).toBe(200);
            expect(response.body.totalChats).toBe(150);
            expect(response.body.activeUsers).toBe(25);
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3l1c3VrZXlvc2hpb2thL3Byb2plY3RzL3lvdXR1YmUvYWktY2hhdC9haS1jaGF0LWFwaS90ZXN0cy9yb3V0ZXMvZGFzaGJvYXJkLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFZQSxvQkFBb0I7QUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBQ2xDLElBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUN2QyxJQUFJLENBQUMsSUFBSSxDQUFDLDhCQUE4QixDQUFDLENBQUM7QUFmMUMsMERBQWdDO0FBQ2hDLHNEQUE4QjtBQUM5QixpREFBOEM7QUFDOUMsMkVBQXlEO0FBQ3pELG9EQUEyRDtBQUMzRCwwREFBaUU7QUFDakUscURBSStCO0FBTy9CLFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDaEMsSUFBSSxHQUF3QixDQUFDO0lBRTdCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxHQUFHLEdBQUcsSUFBQSxpQkFBTyxHQUFFLENBQUM7UUFDaEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxpQkFBTyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDeEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxtQkFBZSxDQUFDLENBQUM7UUFFM0MseUJBQXlCO1FBQ3hCLHFCQUE0QixDQUFDLGtCQUFrQixDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRTtZQUNsRSxHQUFHLENBQUMsSUFBSSxtQ0FBUSxvQkFBUSxLQUFFLFlBQVksRUFBRSw0QkFBZ0IsR0FBRSxDQUFDO1lBQzNELElBQUksRUFBRSxDQUFDO1FBQ1QsQ0FBQyxDQUFDLENBQUM7UUFFRiwyQkFBK0IsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUU7WUFDckUsSUFBSSxFQUFFLENBQUM7UUFDVCxDQUFDLENBQUMsQ0FBQztRQUVILGtCQUFr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RUFBQyxHQUFHLENBQUM7aUJBQ2hDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQztpQkFDckIsR0FBRyxDQUNGLGVBQWUsRUFDZixVQUFVLElBQUEsNkJBQWlCLEVBQUMsb0JBQVEsQ0FBQyxFQUFFLEVBQUUsNEJBQWdCLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FDaEUsQ0FBQztZQUVKLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3l1c3VrZXlvc2hpb2thL3Byb2plY3RzL3lvdXR1YmUvYWktY2hhdC9haS1jaGF0LWFwaS90ZXN0cy9yb3V0ZXMvZGFzaGJvYXJkLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJlcXVlc3QgZnJvbSAnc3VwZXJ0ZXN0JztcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi4vLi4vc3JjL2xpYi9wcmlzbWEnO1xuaW1wb3J0IGRhc2hib2FyZFJvdXRlciBmcm9tICcuLi8uLi9zcmMvcm91dGVzL2Rhc2hib2FyZCc7XG5pbXBvcnQgeyBhdXRoTWlkZGxld2FyZSB9IGZyb20gJy4uLy4uL3NyYy9taWRkbGV3YXJlL2F1dGgnO1xuaW1wb3J0IHsgbWV0cmljc01pZGRsZXdhcmUgfSBmcm9tICcuLi8uLi9zcmMvbWlkZGxld2FyZS9tZXRyaWNzJztcbmltcG9ydCB7XG4gIHRlc3RVc2VyLFxuICB0ZXN0T3JnYW5pemF0aW9uLFxuICBnZW5lcmF0ZVRlc3RUb2tlbixcbn0gZnJvbSAnLi4vZml4dHVyZXMvdGVzdC1kYXRhJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnLi4vLi4vc3JjL2xpYi9wcmlzbWEnKTtcbmplc3QubW9jaygnLi4vLi4vc3JjL21pZGRsZXdhcmUvYXV0aCcpO1xuamVzdC5tb2NrKCcuLi8uLi9zcmMvbWlkZGxld2FyZS9tZXRyaWNzJyk7XG5cbmRlc2NyaWJlKCdEYXNoYm9hcmQgUm91dGVzJywgKCkgPT4ge1xuICBsZXQgYXBwOiBleHByZXNzLkFwcGxpY2F0aW9uO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGFwcCA9IGV4cHJlc3MoKTtcbiAgICBhcHAudXNlKGV4cHJlc3MuanNvbigpKTtcbiAgICBhcHAudXNlKCcvYXBpL2Rhc2hib2FyZCcsIGRhc2hib2FyZFJvdXRlcik7XG5cbiAgICAvLyBTZXR1cCBtaWRkbGV3YXJlIG1vY2tzXG4gICAgKGF1dGhNaWRkbGV3YXJlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgcmVxLnVzZXIgPSB7IC4uLnRlc3RVc2VyLCBvcmdhbml6YXRpb246IHRlc3RPcmdhbml6YXRpb24gfTtcbiAgICAgIG5leHQoKTtcbiAgICB9KTtcblxuICAgIChtZXRyaWNzTWlkZGxld2FyZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIG5leHQoKTtcbiAgICB9KTtcblxuICAgIC8vIFJlc2V0IGFsbCBtb2Nrc1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9hcGkvZGFzaGJvYXJkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGRhc2hib2FyZCBtZXRyaWNzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tUb3RhbENoYXRzID0gMTI1MDtcbiAgICAgIGNvbnN0IG1vY2tBY3RpdmVVc2VycyA9IDQ1O1xuICAgICAgY29uc3QgbW9ja1JlY2VudENoYXRzID0gW1xuICAgICAgICB7IGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTVUMTA6MDA6MDBaJykgfSxcbiAgICAgICAgeyBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE1VDExOjMwOjAwWicpIH0sXG4gICAgICAgIHsgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xNVQxNDoxNTowMFonKSB9LFxuICAgICAgXTtcblxuICAgICAgLy8gTW9jayBQcmlzbWEgcXVlcmllc1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1RvdGFsQ2hhdHMpO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FjdGl2ZVVzZXJzKTtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZWNlbnRDaGF0cyk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgdG90YWxDaGF0czogbW9ja1RvdGFsQ2hhdHMsXG4gICAgICAgIGFjdGl2ZVVzZXJzOiBtb2NrQWN0aXZlVXNlcnMsXG4gICAgICAgIGF2Z1Jlc3BvbnNlVGltZTogMjUwLCAvLyBIYXJkY29kZWQgdmFsdWVcbiAgICAgICAgZXJyb3JSYXRlOiAwLjAyLCAvLyBIYXJkY29kZWQgdmFsdWVcbiAgICAgICAgdGltZXN0YW1wOiBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHRpbWVzdGFtcCBpcyB2YWxpZCBJU08gc3RyaW5nXG4gICAgICBleHBlY3QobmV3IERhdGUocmVzcG9uc2UuYm9keS50aW1lc3RhbXApKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgIGV4cGVjdChuZXcgRGF0ZShyZXNwb25zZS5ib2R5LnRpbWVzdGFtcCkuZ2V0VGltZSgpKS50b0JlR3JlYXRlclRoYW4oXG4gICAgICAgIERhdGUubm93KCkgLSA1MDAwXG4gICAgICApOyAvLyBXaXRoaW4gbGFzdCA1IHNlY29uZHNcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcXVlcnkgdG90YWwgY2hhdHMgY291bnQgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTAwKTtcbiAgICAgIChwcmlzbWEudXNlci5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwKTtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWEuY2hhdExvZy5jb3VudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcXVlcnkgYWN0aXZlIHVzZXJzIGluIGxhc3QgMjQgaG91cnMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTAwKTtcbiAgICAgIChwcmlzbWEudXNlci5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwKTtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGNvbnN0IHR3ZW50eUZvdXJIb3Vyc0FnbyA9IG5ldyBEYXRlKERhdGUubm93KCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcblxuICAgICAgZXhwZWN0KHByaXNtYS51c2VyLmNvdW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgY2hhdExvZ3M6IHtcbiAgICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgZ3RlOiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSB0aGUgZGF0ZSBpcyBhcHByb3hpbWF0ZWx5IDI0IGhvdXJzIGFnbyAod2l0aGluIDEgbWludXRlIHRvbGVyYW5jZSlcbiAgICAgIGNvbnN0IGNhbGxBcmdzID0gKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9jay5jYWxsc1swXVswXTtcbiAgICAgIGNvbnN0IGFjdHVhbERhdGUgPSBjYWxsQXJncy53aGVyZS5jaGF0TG9ncy5zb21lLmNyZWF0ZWRBdC5ndGU7XG4gICAgICBjb25zdCB0aW1lRGlmZiA9IE1hdGguYWJzKFxuICAgICAgICBhY3R1YWxEYXRlLmdldFRpbWUoKSAtIHR3ZW50eUZvdXJIb3Vyc0Fnby5nZXRUaW1lKClcbiAgICAgICk7XG4gICAgICBleHBlY3QodGltZURpZmYpLnRvQmVMZXNzVGhhbig2MDAwMCk7IC8vIExlc3MgdGhhbiAxIG1pbnV0ZSBkaWZmZXJlbmNlXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHF1ZXJ5IHJlY2VudCBjaGF0cyBpbiBsYXN0IDI0IGhvdXJzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwMCk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMCk7XG4gICAgICAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocHJpc21hLmNoYXRMb2cuZmluZE1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgIGd0ZTogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IG9ubHkgY3JlYXRlZEF0IGlzIHNlbGVjdGVkIGZvciBwcml2YWN5IGFuZCBwZXJmb3JtYW5jZVxuICAgICAgY29uc3QgY2FsbEFyZ3MgPSAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzWzBdWzBdO1xuICAgICAgZXhwZWN0KGNhbGxBcmdzLnNlbGVjdCkudG9FcXVhbCh7IGNyZWF0ZWRBdDogdHJ1ZSB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBhbGwgcXVlcmllcyBpbiBwYXJhbGxlbCBmb3IgcGVyZm9ybWFuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb3VudERlbGF5ID0gMTAwO1xuICAgICAgY29uc3QgdXNlckNvdW50RGVsYXkgPSAxNTA7XG4gICAgICBjb25zdCBmaW5kTWFueURlbGF5ID0gMTIwO1xuXG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgICgpID0+XG4gICAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZSgxMDApLCBjb3VudERlbGF5KSlcbiAgICAgICk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgICgpID0+XG4gICAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUoMTApLCB1c2VyQ291bnREZWxheSlcbiAgICAgICAgICApXG4gICAgICApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICAoKSA9PlxuICAgICAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUoW10pLCBmaW5kTWFueURlbGF5KSlcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIFNob3VsZCB0YWtlIHJvdWdobHkgdGhlIHRpbWUgb2YgdGhlIGxvbmdlc3QgcXVlcnkgKG5vdCB0aGUgc3VtIG9mIGFsbClcbiAgICAgIGV4cGVjdCh0b3RhbFRpbWUpLnRvQmVMZXNzVGhhbihcbiAgICAgICAgY291bnREZWxheSArIHVzZXJDb3VudERlbGF5ICsgZmluZE1hbnlEZWxheVxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh0b3RhbFRpbWUpLnRvQmVHcmVhdGVyVGhhbihcbiAgICAgICAgTWF0aC5tYXgoY291bnREZWxheSwgdXNlckNvdW50RGVsYXksIGZpbmRNYW55RGVsYXkpIC0gNTBcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBoYXJkY29kZWQgYXZnUmVzcG9uc2VUaW1lIGFuZCBlcnJvclJhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5hdmdSZXNwb25zZVRpbWUpLnRvQmUoMjUwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmVycm9yUmF0ZSkudG9CZSgwLjAyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcm91bmQgYXZnUmVzcG9uc2VUaW1lIGFuZCBlcnJvclJhdGUgYXBwcm9wcmlhdGVseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwMCk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMCk7XG4gICAgICAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIC8vIGF2Z1Jlc3BvbnNlVGltZSBzaG91bGQgYmUgcm91bmRlZCB0byBuZWFyZXN0IGludGVnZXJcbiAgICAgIGV4cGVjdChOdW1iZXIuaXNJbnRlZ2VyKHJlc3BvbnNlLmJvZHkuYXZnUmVzcG9uc2VUaW1lKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gZXJyb3JSYXRlIHNob3VsZCBiZSByb3VuZGVkIHRvIDMgZGVjaW1hbCBwbGFjZXNcbiAgICAgIGV4cGVjdChcbiAgICAgICAgcmVzcG9uc2UuYm9keS5lcnJvclJhdGUudG9TdHJpbmcoKS5zcGxpdCgnLicpWzFdPy5sZW5ndGggfHwgMFxuICAgICAgKS50b0JlTGVzc1RoYW5PckVxdWFsKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgemVybyB2YWx1ZXMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMCk7XG4gICAgICAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgdG90YWxDaGF0czogMCxcbiAgICAgICAgYWN0aXZlVXNlcnM6IDAsXG4gICAgICAgIGF2Z1Jlc3BvbnNlVGltZTogMjUwLFxuICAgICAgICBlcnJvclJhdGU6IDAuMDIsXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsYXJnZSBudW1iZXJzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxhcmdlQ2hhdENvdW50ID0gOTk5OTk5O1xuICAgICAgY29uc3QgbGFyZ2VVc2VyQ291bnQgPSA1MDAwMDtcblxuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobGFyZ2VDaGF0Q291bnQpO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobGFyZ2VVc2VyQ291bnQpO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS50b3RhbENoYXRzKS50b0JlKGxhcmdlQ2hhdENvdW50KTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmFjdGl2ZVVzZXJzKS50b0JlKGxhcmdlVXNlckNvdW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9kYXNoYm9hcmQnKVxuICAgICAgICAuc2V0KFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJyxcbiAgICAgICAgICBgQmVhcmVyICR7Z2VuZXJhdGVUZXN0VG9rZW4odGVzdFVzZXIuaWQsIHRlc3RPcmdhbml6YXRpb24uaWQpfWBcbiAgICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg1MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvRXF1YWwoe1xuICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBkYXNoYm9hcmQgZGF0YScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHBhcnRpYWwgZGF0YWJhc2UgZmFpbHVyZXMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwMCk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEVycm9yKCdVc2VyIHF1ZXJ5IGZhaWxlZCcpXG4gICAgICApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDUwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9FcXVhbCh7XG4gICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGRhc2hib2FyZCBkYXRhJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsb2cgZXJyb3JzIHRvIGNvbnNvbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25zb2xlRXJyb3JTcHkgPSBqZXN0XG4gICAgICAgIC5zcHlPbihjb25zb2xlLCAnZXJyb3InKVxuICAgICAgICAubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcbiAgICAgIGNvbnN0IG1vY2tFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcblxuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUobW9ja0Vycm9yKTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnRGFzaGJvYXJkIGVycm9yOicsXG4gICAgICAgIG1vY2tFcnJvclxuICAgICAgKTtcblxuICAgICAgY29uc29sZUVycm9yU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsL3VuZGVmaW5lZCByZXNwb25zZXMgZnJvbSBkYXRhYmFzZScsIGFzeW5jICgpID0+IHtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9NYXRjaE9iamVjdCh7XG4gICAgICAgIHRvdGFsQ2hhdHM6IG51bGwsXG4gICAgICAgIGFjdGl2ZVVzZXJzOiB1bmRlZmluZWQsXG4gICAgICAgIGF2Z1Jlc3BvbnNlVGltZTogMjUwLFxuICAgICAgICBlcnJvclJhdGU6IDAuMDIsXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSByZWNlbnQgY2hhdHMgYXJyYXknLCBhc3luYyAoKSA9PiB7XG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS50b3RhbENoYXRzKS50b0JlKDEwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5hY3RpdmVVc2VycykudG9CZSgxMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSByZWNlbnQgY2hhdHMgd2l0aCB2YXJpb3VzIHRpbWVzdGFtcHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZWNlbnRDaGF0cyA9IFtcbiAgICAgICAgeyBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE1VDIzOjU5OjU5WicpIH0sXG4gICAgICAgIHsgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xNVQxMjowMDowMFonKSB9LFxuICAgICAgICB7IGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTVUMDA6MDA6MDFaJykgfSxcbiAgICAgIF07XG5cbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwMCk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMCk7XG4gICAgICAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShyZWNlbnRDaGF0cyk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnRvdGFsQ2hhdHMpLnRvQmUoMTAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmFjdGl2ZVVzZXJzKS50b0JlKDEwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0F1dGhlbnRpY2F0aW9uIGFuZCBhdXRob3JpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVxdWlyZSBhdXRoZW50aWNhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIChhdXRoTWlkZGxld2FyZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKHJlcSwgcmVzKSA9PiB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApLmdldCgnL2FwaS9kYXNoYm9hcmQnKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvRXF1YWwoeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZXF1aXJlIGFkbWluIHBlcm1pc3Npb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUmVndWxhciB1c2VyIHNob3VsZCBiZSBhYmxlIHRvIGFjY2VzcyBkYXNoYm9hcmRcbiAgICAgIGNvbnN0IHJlZ3VsYXJVc2VyID0geyAuLi50ZXN0VXNlciwgcm9sZXM6IFsndXNlciddIH07XG5cbiAgICAgIChhdXRoTWlkZGxld2FyZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgICAgcmVxLnVzZXIgPSB7IC4uLnJlZ3VsYXJVc2VyLCBvcmdhbml6YXRpb246IHRlc3RPcmdhbml6YXRpb24gfTtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgfSk7XG5cbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwMCk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMCk7XG4gICAgICAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHJlZ3VsYXJVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgbWV0cmljcyBtaWRkbGV3YXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWV0cmljc01pZGRsZXdhcmVTcHkgPSBqZXN0LmZuKChyZXEsIHJlcywgbmV4dCkgPT4gbmV4dCgpKTtcbiAgICAgIChtZXRyaWNzTWlkZGxld2FyZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihtZXRyaWNzTWlkZGxld2FyZVNweSk7XG5cbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwMCk7XG4gICAgICAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMCk7XG4gICAgICAocHJpc21hLmNoYXRMb2cuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QobWV0cmljc01pZGRsZXdhcmVTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgbWlkZGxld2FyZSBpbiBjb3JyZWN0IG9yZGVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWlkZGxld2FyZU9yZGVyOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAoYXV0aE1pZGRsZXdhcmUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICAgIG1pZGRsZXdhcmVPcmRlci5wdXNoKCdhdXRoJyk7XG4gICAgICAgIHJlcS51c2VyID0geyAuLi50ZXN0VXNlciwgb3JnYW5pemF0aW9uOiB0ZXN0T3JnYW5pemF0aW9uIH07XG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAobWV0cmljc01pZGRsZXdhcmUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICAgIG1pZGRsZXdhcmVPcmRlci5wdXNoKCdtZXRyaWNzJyk7XG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9kYXNoYm9hcmQnKVxuICAgICAgICAuc2V0KFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJyxcbiAgICAgICAgICBgQmVhcmVyICR7Z2VuZXJhdGVUZXN0VG9rZW4odGVzdFVzZXIuaWQsIHRlc3RPcmdhbml6YXRpb24uaWQpfWBcbiAgICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1pZGRsZXdhcmVPcmRlcikudG9FcXVhbChbJ2F1dGgnLCAnbWV0cmljcyddKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHByb2NlZWQgaWYgYXV0aCBtaWRkbGV3YXJlIGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGF1dGhNaWRkbGV3YXJlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uT25jZSgocmVxLCByZXMpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1Rva2VuIGV4cGlyZWQnIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1ldHJpY3NNaWRkbGV3YXJlU3B5ID0gamVzdC5mbigpO1xuICAgICAgKG1ldHJpY3NNaWRkbGV3YXJlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKG1ldHJpY3NNaWRkbGV3YXJlU3B5KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9kYXNoYm9hcmQnKVxuICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciBpbnZhbGlkLXRva2VuYCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAxKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzTWlkZGxld2FyZVNweSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChwcmlzbWEuY2hhdExvZy5jb3VudCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BlcmZvcm1hbmNlIGNvbnNpZGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMgZWZmaWNpZW50bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXF1ZXN0cyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwIH0sICgpID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgICAuc2V0KFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICAgKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocmVxdWVzdHMpO1xuXG4gICAgICByZXNwb25zZXMuZm9yRWFjaCgocmVzcG9uc2UpID0+IHtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS50b3RhbENoYXRzKS50b0JlKDEwMCk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHByaXNtYS5jaGF0TG9nLmNvdW50KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMTApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgZmV0Y2ggdW5uZWNlc3NhcnkgZGF0YSBmb3IgcGVyZm9ybWFuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9kYXNoYm9hcmQnKVxuICAgICAgICAuc2V0KFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJyxcbiAgICAgICAgICBgQmVhcmVyICR7Z2VuZXJhdGVUZXN0VG9rZW4odGVzdFVzZXIuaWQsIHRlc3RPcmdhbml6YXRpb24uaWQpfWBcbiAgICAgICAgKTtcblxuICAgICAgLy8gVmVyaWZ5IHRoYXQgb25seSBjcmVhdGVkQXQgaXMgc2VsZWN0ZWQgZnJvbSByZWNlbnQgY2hhdHNcbiAgICAgIGV4cGVjdChwcmlzbWEuY2hhdExvZy5maW5kTWFueSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICBzZWxlY3Q6IHsgY3JlYXRlZEF0OiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHRoYXQgd2UgZG9uJ3QgZmV0Y2ggZnVsbCBjaGF0IGxvZyBkYXRhXG4gICAgICBjb25zdCBjYWxsQXJncyA9IChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF1bMF07XG4gICAgICBleHBlY3QoY2FsbEFyZ3Muc2VsZWN0KS5ub3QudG9IYXZlUHJvcGVydHkoJ3F1ZXN0aW9uJyk7XG4gICAgICBleHBlY3QoY2FsbEFyZ3Muc2VsZWN0KS5ub3QudG9IYXZlUHJvcGVydHkoJ2Fuc3dlcicpO1xuICAgICAgZXhwZWN0KGNhbGxBcmdzLnNlbGVjdCkubm90LnRvSGF2ZVByb3BlcnR5KCd1c2VyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB0aW1lb3V0IHNjZW5hcmlvcyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBhIHZlcnkgc2xvdyBkYXRhYmFzZSByZXNwb25zZVxuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICAoKSA9PiBuZXcgUHJvbWlzZSgoKSA9PiB7fSkgLy8gTmV2ZXIgcmVzb2x2ZXNcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgIClcbiAgICAgICAgLnRpbWVvdXQoMTAwMCk7XG5cbiAgICAgIC8vIFRoZSByZXF1ZXN0IHNob3VsZCB0aW1lb3V0LCB3aGljaCBzdXBlcnRlc3QgaGFuZGxlcyBhcHByb3ByaWF0ZWx5XG4gICAgICAvLyBJbiBhIHJlYWwgc2NlbmFyaW8sIHlvdSBtaWdodCB3YW50IHRvIGltcGxlbWVudCByZXF1ZXN0IHRpbWVvdXRzIGluIHRoZSByb3V0ZSBoYW5kbGVyXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIGFjY3VyYWN5IGFuZCBjb25zaXN0ZW5jeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVzZSBjb25zaXN0ZW50IDI0LWhvdXIgdGltZSB3aW5kb3cgYWNyb3NzIHF1ZXJpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAocHJpc21hLmNoYXRMb2cuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDApO1xuICAgICAgKHByaXNtYS51c2VyLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9kYXNoYm9hcmQnKVxuICAgICAgICAuc2V0KFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJyxcbiAgICAgICAgICBgQmVhcmVyICR7Z2VuZXJhdGVUZXN0VG9rZW4odGVzdFVzZXIuaWQsIHRlc3RPcmdhbml6YXRpb24uaWQpfWBcbiAgICAgICAgKTtcblxuICAgICAgLy8gQm90aCB1c2VyLmNvdW50IGFuZCBjaGF0TG9nLmZpbmRNYW55IHNob3VsZCB1c2UgdGhlIHNhbWUgdGltZSB0aHJlc2hvbGRcbiAgICAgIGNvbnN0IHVzZXJDb3VudENhbGwgPSAocHJpc21hLnVzZXIuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzWzBdWzBdO1xuICAgICAgY29uc3QgY2hhdExvZ0ZpbmRDYWxsID0gKHByaXNtYS5jaGF0TG9nLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1xuICAgICAgICAuY2FsbHNbMF1bMF07XG5cbiAgICAgIGNvbnN0IHVzZXJEYXRlID0gdXNlckNvdW50Q2FsbC53aGVyZS5jaGF0TG9ncy5zb21lLmNyZWF0ZWRBdC5ndGU7XG4gICAgICBjb25zdCBjaGF0RGF0ZSA9IGNoYXRMb2dGaW5kQ2FsbC53aGVyZS5jcmVhdGVkQXQuZ3RlO1xuXG4gICAgICAvLyBEYXRlcyBzaG91bGQgYmUgdmVyeSBjbG9zZSAod2l0aGluIDEgc2Vjb25kIGR1ZSB0byBleGVjdXRpb24gdGltZSlcbiAgICAgIGNvbnN0IHRpbWVEaWZmID0gTWF0aC5hYnModXNlckRhdGUuZ2V0VGltZSgpIC0gY2hhdERhdGUuZ2V0VGltZSgpKTtcbiAgICAgIGV4cGVjdCh0aW1lRGlmZikudG9CZUxlc3NUaGFuKDEwMDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZWRnZSBjYXNlIG9mIGV4YWN0bHkgMjQgaG91cnMgYWdvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXhhY3RseVR3ZW50eUZvdXJIb3Vyc0FnbyA9IG5ldyBEYXRlKFxuICAgICAgICBEYXRlLm5vdygpIC0gMjQgKiA2MCAqIDYwICogMTAwMFxuICAgICAgKTtcblxuICAgICAgKHByaXNtYS5jaGF0TG9nLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTAwKTtcbiAgICAgIChwcmlzbWEudXNlci5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEwKTtcbiAgICAgIChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgeyBjcmVhdGVkQXQ6IGV4YWN0bHlUd2VudHlGb3VySG91cnNBZ28gfSxcbiAgICAgIF0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2Rhc2hib2FyZCcpXG4gICAgICAgIC5zZXQoXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGBCZWFyZXIgJHtnZW5lcmF0ZVRlc3RUb2tlbih0ZXN0VXNlci5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCl9YFxuICAgICAgICApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS50b3RhbENoYXRzKS50b0JlKDEwMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG1haW50YWluIGRhdGEgY29uc2lzdGVuY3kgYWNyb3NzIHBhcmFsbGVsIHF1ZXJpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgY2FsbENvdW50ID0gMDtcbiAgICAgIGNvbnN0IG1vY2tEYXRhID0gWzE1MCwgMjUsIFtdXTsgLy8gdG90YWxDaGF0cywgYWN0aXZlVXNlcnMsIHJlY2VudENoYXRzXG5cbiAgICAgIChwcmlzbWEuY2hhdExvZy5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobW9ja0RhdGFbMF0pO1xuICAgICAgfSk7XG5cbiAgICAgIChwcmlzbWEudXNlci5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobW9ja0RhdGFbMV0pO1xuICAgICAgfSk7XG5cbiAgICAgIChwcmlzbWEuY2hhdExvZy5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobW9ja0RhdGFbMl0pO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvZGFzaGJvYXJkJylcbiAgICAgICAgLnNldChcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbicsXG4gICAgICAgICAgYEJlYXJlciAke2dlbmVyYXRlVGVzdFRva2VuKHRlc3RVc2VyLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKX1gXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnRvdGFsQ2hhdHMpLnRvQmUoMTUwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmFjdGl2ZVVzZXJzKS50b0JlKDI1KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==