# DevBoost Next.js Ã— Express ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„Â v2025

> **ç›®çš„**Â : ã™ã¹ã¦ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ *å¯èª­æ€§ãƒ»å‹å®‰å…¨ãƒ»å¤‰æ›´å®¹æ˜“æ€§* ã®ä¸‰æœ¬æŸ±ã§çµ±ä¸€ã—ã€ãƒã‚°ã®ç™ºç”Ÿã‚’æœ€å°åŒ–ã™ã‚‹ã€‚
>
> æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ãƒªãƒã‚¸ãƒˆãƒªç›´ä¸‹ã® `docs/coding-style.md` ã«ã‚³ãƒŸãƒƒãƒˆã—ã€å¿…è¦ã«å¿œã˜ã¦ PullÂ Request ã§æ›´æ–°ã™ã‚‹ã€‚

---

## 0. TL;DR ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

| é …ç›®                              | MUST            | WHY                          |
| --------------------------------- | --------------- | ---------------------------- |
| **1 file = 1 è²¬å‹™**               | âœ…               | èª­ã¿ã‚„ã™ã•ãƒ»å¤‰æ›´ç¯„å›²ã®å±€æ‰€åŒ– |
| **å‹ã®å˜ä¸€ã‚½ãƒ¼ã‚¹**                | âœ… `_schemas/**` | å‹é‡è¤‡ã«ã‚ˆã‚‹ä¸æ•´åˆã‚’é˜²ã     |
| **page.tsx ã¯ 50 è¡Œä»¥å†…**         | âœ…               | ãƒšãƒ¼ã‚¸ã¯ *é…ç·š* ã®ã¿         |
| **å®šæ•°ã¯ \_config/**              | âœ…               | ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼æ’²æ»…         |
| **ãƒ¢ãƒƒã‚¯ = \_fixtures/ â†’ seeds/** | âœ…               | FE/BE ã§å†åˆ©ç”¨ãƒ»ãƒ‰ãƒªãƒ•ãƒˆé˜²æ­¢ |

---

## 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
app/
â”œâ”€ _components/        # çŠ¶æ…‹ã‚’æŒãŸãªã„ç´”ç²‹ UI
â”œâ”€ _hooks/             # TanStack Query / Zustand ãªã©çŠ¶æ…‹ç®¡ç†
â”œâ”€ _utils/             # ç´”ç²‹é–¢æ•°
â”œâ”€ _schemas/           # Zod | OpenAPI | JSON-Schemaï¼ˆå˜ä¸€ã‚½ãƒ¼ã‚¹ï¼‰
â”œâ”€ _domains/           # è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹ + ãƒ•ãƒ­ãƒ³ãƒˆå›ºæœ‰è£œåŠ©å‹
â”œâ”€ _config/            # å®šæ•°ãƒ»ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ãƒˆãƒ¼ã‚¯ãƒ³
â”œâ”€ _fixtures/          # Zod ç”±æ¥ã®ãƒ•ã‚§ã‚¤ã‚¯ãƒ‡ãƒ¼ã‚¿ï¼ˆmsw ç”¨ï¼‰
â””â”€ (auth|org|â€¦)/â€¦/page.tsx  # ãƒšãƒ¼ã‚¸ = Hook + UI ã®é…ç·š
backend/
â”œâ”€ src/
â”‚   â”œâ”€ routes/         # Express ãƒ«ãƒ¼ãƒˆ
â”‚   â”œâ”€ controllers/
â”‚   â”œâ”€ models/
â”‚   â””â”€ seeds/          # _fixtures ã‹ã‚‰ import â†’ DB ã¸æŠ•å…¥
â””â”€ prisma/
```

> **å¤‰æ›´å±¥æ­´**ã¯ `docs/CHANGELOG.md` ã§ç®¡ç†ã€‚

---

## 2. page.tsx ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æŒ‡é‡

| ãƒ¬ã‚¤ãƒ¤ | ãƒ•ã‚¡ã‚¤ãƒ«ä¾‹                                 | è¡Œæ•°ä¸Šé™    | è²¬å‹™                                                       |
| ------ | ------------------------------------------ | ----------- | ---------------------------------------------------------- |
| Page   | `(org)/admin/[orgId]/billing/page.tsx`     | **â‰¤ 50 è¡Œ** | â‘  ãƒ«ãƒ¼ãƒˆå¼•æ•°å–å¾—<br>â‘¡ Hook å‘¼å‡º<br>â‘¢ UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆæˆ |
| Hook   | `_hooks/billing/useBilling.ts`             | 100â€“150 è¡Œ  | APIÂ fetch / ã‚­ãƒ£ãƒƒã‚·ãƒ¥ / ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åˆ¶å¾¡                  |
| UI     | `_components/feature/billing/PlanGrid.tsx` | 150 è¡Œ      | JSX + Tailwindã€‚çŠ¶æ…‹ã¯å—ã‘å–ã‚‹ã ã‘                         |

* **ç¦æ­¢** : ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»çŠ¶æ…‹ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ã‚’ page.tsx ã¸ç›´æ›¸ãã€‚
* **ãƒšãƒ¼ã‚¸å›ºæœ‰ãƒ˜ãƒ«ãƒ‘**ã¯ `_hooks/â€¦/useBillingPage.ts` ã¨ã—ã¦ colocationã€‚

---

## 3. å‹å®šç¾© & ã‚¹ã‚­ãƒ¼ãƒç®¡ç†

### 3.1 å˜ä¸€ã‚½ãƒ¼ã‚¹ãƒ»ã‚ªãƒ–ãƒ»ãƒˆã‚¥ãƒ«ãƒ¼ã‚¹

* **Zod** ã‚’æ¡ç”¨ã— **`_schemas/**`** ã«å…¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆã€‚ä¾‹ :

  ```ts
  // _schemas/auth.ts
  import { z } from "zod";
  export const userSchema = z.object({
    id: z.string().uuid(),
    email: z.string().email(),
    role: z.enum(["user", "admin"]),
  });
  export type User = z.infer<typeof userSchema>;
  ```
* **é‡è¤‡ç¦æ­¢** : æ—¢å­˜ã® `_schemas/auth.ts` ã¨ `_schemas/user.ts` ã¯ **çµ±åˆ** ã—ã€`auth.ts` ã«ã¾ã¨ã‚ã‚‹ã€‚

### 3.2 å‹ç”Ÿæˆãƒ•ãƒ­ãƒ¼

1. `pnpm generate:types` ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ

   * **zod-to-ts** : `_schemas/**` â†’ `_domains/**`
   * **openapi-typescript-codegen** : å¿…è¦ãªã‚‰ OpenAPI â†’ Swagger Client
2. \_domains ã«ç”Ÿæˆç‰© (`*.gen.ts`) ãŒç½®ã‹ã‚Œã€ãƒ•ãƒ­ãƒ³ãƒˆã¯ãã‚Œã‚’ importã€‚
3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (Express) ã§ã¯åŒã˜ã‚¹ã‚­ãƒ¼ãƒã‚’ `zod` ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

> **æ³¨æ„** : `_domains` ã¯ *ç”Ÿæˆç‰© + ãƒ•ãƒ­ãƒ³ãƒˆå›ºæœ‰ Utility å‹* ã«é™å®šã—ã€æ‰‹æ›¸ãå‹ã¯æœ€å°é™ã€‚

---

## 4. å®šæ•° & ã‚³ãƒ³ãƒ•ã‚£ã‚°

* **ä¸å¤‰å€¤ â†’ `_config/**`** ã«é›†ç´„ã—ã€import ã—ã¦ä½¿ç”¨ã€‚
* ä¾‹ :

  ```ts
  // _config/billing/plans.ts
  export const BILLING_PLANS = [
    { tier: "free", price: 0 },
    { tier: "pro", price: 29 },
  ] as const;
  ```
* **ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ç¦æ­¢** â€“ ç›´æ¥æ•°å€¤ã‚„æ–‡å­—åˆ—ã‚’æ›¸ã‹ãšå®šæ•°ã‚’å‚ç…§ã€‚

---

## 5. ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ & ã‚·ãƒ¼ãƒ‰æˆ¦ç•¥

| ãƒ•ã‚§ãƒ¼ã‚º | å ´æ‰€                   | åˆ©ç”¨æ–¹æ³•                           |
| -------- | ---------------------- | ---------------------------------- |
| é–‹ç™º     | `_fixtures/**`         | `msw` ã§ FE ãƒ¢ãƒƒã‚¯ API / Storybook |
| æœ¬ç•ª     | `backend/src/seeds/**` | Prisma / Sequelize seed script     |

* `_fixtures` ã¯ **\_schemas ã®ã‚¹ã‚­ãƒ¼ãƒ** ã‚’ä½¿ã£ã¦ faker ç”Ÿæˆ (`@faker-js/faker`).
* ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ `seed` ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ `_fixtures` ã‚’ import ã—ã¦ DB ã¸æŠ•å…¥ â†’ ãƒ¢ãƒƒã‚¯ã¨å®Ÿãƒ‡ãƒ¼ã‚¿ã®ãƒ‰ãƒªãƒ•ãƒˆãŒç„¡ããªã‚‹ã€‚

```ts
// backend/src/seeds/seed-users.ts
import { faker } from "@faker-js/faker";
import { userSchema } from "../../../../app/_schemas/auth";
```

---

## 6. å‘½å & ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¨™æº–

* **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** : `PascalCase.tsx`
* **Hook** : `useSomething.ts`
* **Boolean å¤‰æ•°** : `isXxx / hasXxx / canXxx`
* **Handler** : `handleSubmit`
* **ç’°å¢ƒå¤‰æ•°** : `NEXT_PUBLIC_*` ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã§ãƒ•ãƒ­ãƒ³ãƒˆã‹ã‚‰ã®ã¿å‚ç…§å¯èƒ½ã€‚

---

## 7. Lint / ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ / CI

* ESLint + Prettier + Stylelint = **Airbnb + Next + TypeScript** æ‹¡å¼µã€‚
* è¿½åŠ ãƒ«ãƒ¼ãƒ«

  * `max-lines-per-file`: 300
  * `complexity`: 10
  * `@typescript-eslint/no-misused-promises`
* Git Hooks

  * `pre-commit`: `lint-staged` ã§ format & test
  * `pre-push`: `pnpm test:ci && pnpm build`

---

## 8. ãƒ†ã‚¹ãƒˆ

* **Unit** : Vitest / Jest + tsâ€‘jest
* **Component** : React Testing Library + `@testing-library/jest-dom`
* **E2E** : Playwright (CI ã§ `next build && playwright test`)
* **Storybook** : mock çŠ¶æ…‹ (loading / error / empty) ã‚’å¿…ãšä½œæˆ

---

## 9. Git é‹ç”¨

* Conventional Commits (`feat:`, `fix:`, `refactor:`â€¦)
* PR ãƒãƒªã‚·ãƒ¼

  * 1Â æ©Ÿèƒ½ã‚ãŸã‚Š **â‰¤ 400 è¡Œ**
  * UI å¤‰æ›´æ™‚ã¯ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå¿…é ˆ
  * å‹è¿½åŠ ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ã¯åˆ¥ PR

---

## 10. ä»Šå¾Œã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ‰‹é †

1. æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã€`docs/coding-style.md` ã‚’ç›´æ¥ç·¨é›†ã— PR ä½œæˆã€‚
2. **`codestyle` ãƒ©ãƒ™ãƒ«** ã‚’ä»˜ä¸ã€‚
3. ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¢å…¨å“¡ãŒ ğŸ‘ ã§ãƒãƒ¼ã‚¸ã€‚

---

âœ… **ã“ã‚Œã§å¯èª­æ€§ã¨ãƒã‚°è€æ€§ã‚’ä¸¡ç«‹ã™ã‚‹åŸºç›¤ãŒå®Œæˆ**ã€‚å¼•ãç¶šãé‹ç”¨ã—ãªãŒã‚‰æ”¹å–„ã—ã¦ã„ãã¾ã—ã‚‡